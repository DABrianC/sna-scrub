{"title":"Annex 3: More on Centrality Statistics","markdown":{"yaml":{"title":"Annex 3: More on Centrality Statistics","format":{"html":{"toc":true,"css":"prep/styles.css"}},"execute":{"warning":false,"message":false,"error":false,"echo":false},"editor":"visual"},"headingText":"Centrality Statistics","containsRefs":false,"markdown":"\n\n```{r}\nsource(here::here(\"./prep/prep.r\"))\nsource(here::here(\"./scripts/00 cleaning script.R\"))\nsource(here::here(\"./scripts/01 descriptives.R\"))\nsource(here::here(\"./scripts/01 analysis subgraphs script.R\"))\nsource(here::here(\"./scripts/01 analysis script.R\"))\n```\n\n\nGlobal centrality statistics help understand each node's place in the overall network and whether or not they are connected to many or few other nodes in the network. Knowing this information helps to determine if an organization may be more or less influential than other organizations in the network.\n\nFour commonly used centrality statistics are Betweenness Centrality, Closeness, Eigenvector Centrality, and Degree Centrality (overall, out, and in).\n\n**Betweenness centrality** measures the extent to which an organization is connected to other network actors that are not connected to each other. Nodes with high betweenness serve as bridges between different parts of a network.\n\n**Closeness** calculates the average distance between a node and all other nodes in a network. It is used to identify nodes that reach other nodes quickly. In disconnected networks, it may be necessary to use **Harmonic Centrality** instead.\n\n**Eigenvector Centrality** is a measure of the influence of a node in a network. Those nodes that are connected to other well-connected nodes will have high eigenvector centrality scores.\n\n**Degree Centrality** is a count of the number of connections of each node. In directed networks it can have both an **in-degree** and an **out-degree** score. The out-degree score denotes the number of connections the node initiates, and the in-degree score denotes the number of connections the node receives. The overall degree score is the sum of the in-degree and the out-degree scores.\n\nAdditionally, a network's **density** is a useful statistic to understand, but it is hard to put in context. The calculation is the number of connections divided by the total possible number of connections. A network density of 1 means that all nodes are connected to each other. This is common in small, friend group networks, but less common in real-world networks. It would not make sense for a network to be perfectly dense, and optimal density is hard to define. The endline network has a density of `{r} igraph::edge_density(g_non)`.\n\n```{r}\n\ndat_all1 <- dat_all |> \n  mutate(Density = paste0(round(Density, digits = 0), \"%\")\n         , 'Avg. Harmonic Centrality \\n(Closeness)' = round(`Avg. Harmonic Centrality \\n(Closeness)`, digits = 2)\n         , 'Avg. Betweenness' = round(`Avg. Betweenness`, digits = 2)\n         , 'Avg. Eigenvector' = round(`Avg. Eigenvector`, digits = 2))\n\nflex_fun(data = dat_all1)\n\n```\n\n## Neighborhoods\n\n```{r}\nsource(here::here(\"./prep/prep.r\"))\nsource(here::here(\"./scripts/00 cleaning script.R\"))\nsource(here::here(\"./scripts/01 analysis script.R\"))\nsource(here::here(\"./scripts/01 analysis subgraphs script.R\"))\n\n```\n\nWithin this network of anti-corruption organizations, the grantees work within four thematic areas:\n\n-   Joinbodi\n-   Behavior Change\n-   Criminal Justice, and\n-   Media and Journalism.\n\nTo better understand each of these grantees and those non-grantees who are associated with each of them, the evaluation team created four **neighborhoods**, one for each of the cohorts. Each neighborhood consists of the grantee organizations who are officially part of this cohort, and all other organizations in the network -- grantee and non-grantee -- who are first order connections. Below, each neighborhood is presented visually and statistically to identify its key organizations.\n\n## Joinbodi\n\nThe Joinbodi neighborhoods consists of `{r} gorder(joinbodi_nbhd)` organizations and `{r} gsize(joinbodi_nbhd)` connections. The organizations are made up of `{r} sum(V(joinbodi_nbhd)$cohort == \"JoinBodi\")` that are JoinBodi grantees, `{r} sum(V(joinbodi_nbhd)$cohort %in% c(\"Media and Journalism\", \"Behavior Change\", \"Criminal Justice\"))` that are grantees in one of the other three cohorts, and `{r} sum(V(joinbodi_nbhd)$cohort == \"Non Grantee\")` non-grantees.\n\n```{r}\nDT::datatable(joinbodi_nbhd_centrality_scores,\n              caption = htmltools::tags$caption(\n    style = 'caption-side: bottom; text-align: left;',\n    'Table 1: ', htmltools::em('Centrality statistics the JoinBodi neighborhood.')\n  ))\n\n```\n\n### JoinBodi neighborhood network visualization\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\nggraph(joinbodi_nbhd, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\"), threshold = .4, n_cycle = 2) +\n  geom_node_point(aes(size = betweenness, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = betweenness, shape = grantee, color = ifelse(group == \"JoinBodi\", \"JoinBodi\", \"Other\")), alpha = .8)+\n  geom_node_text(aes(label = ifelse(group == \"JoinBodi\", names_pretty, NA)), size = 3, repel = TRUE) +\n  scale_color_manual(values = c(\"JoinBodi\" = palette[[3]], \"Other\" = \"grey\")) +\n  scale_size(range = c(2, 6)) +\n  labs(title = \"<span style = 'color:#5B507A;'>JoinBodi neighborhood</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n\n```\n\n### JoinBodi: Top 10 Organizations by Centrality Statistic\n\n```{r}\n\nflex_fun(scores_table_joinbodi)\n\n```\n\nEach of the four cohorts' nodes is highlighted in the panels below.\n\n::: panel-tabset\n## Behavior Change\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\nggraph(g_non, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\")\n                  , threshold = .4, n_cycle = 2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = degree, shape = grantee, color = ifelse(group == \"Behavior Change\", \"Behavior Change\", \"Other\")))+\n  geom_node_text(aes(label = ifelse(group == \"Behavior Change\", acronym, NA)), size = 5, repel = TRUE, check_overlap = FALSE, max.overlaps = 20) +\n  ggforce::geom_mark_hull(\n    aes(x, y, group = cohort\n        , label = cohort\n        , filter = cohort == \"Behavior Change\")\n    , fill = palette[[1]]\n    , label.colour = palette[[1]]\n    , label.fill = NA\n    , label.fontsize = 16\n    , con.colour = palette[[1]],\n    , concavity = 4,\n    expand = unit(2, \"mm\"),\n    alpha = 0.25\n  ) +\n  scale_color_manual(values = c(\"Behavior Change\" = palette[[1]], \"Other\" = \"grey\")) +\n  scale_size(range = c(2, 6)) +\n  #labs(title = \"<span style = 'color:#0964B0;'>Behavior Change Cohort</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n```\n\n## Media and Journalism\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n#Media and Journalism subgraph on g\nggraph(g_non, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\")\n                  , threshold = .4\n                  , n_cycle = 2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = degree, shape = grantee, color = ifelse(group == \"Media and Journalism\", \"Media and Journalism\", \"Other\")))+\n  geom_node_text(aes(label = ifelse(group == \"Media and Journalism\", acronym, NA)), size = 5, repel = TRUE, check_overlap = FALSE, max.overlaps = 20) +\n  ggforce::geom_mark_hull(\n    aes(x, y, group = cohort\n        , label = cohort\n        , filter = cohort == \"Media and Journalism\")\n    , fill = palette[[4]]\n    , label.colour = palette[[4]]\n    , label.fill = NA\n    , label.fontsize = 16\n    , con.colour = palette[[4]],\n    , concavity = 4,\n    expand = unit(2, \"mm\"),\n    alpha = 0.25\n  ) +\n  scale_color_manual(values = c(\"Media and Journalism\" = palette[[4]], \"Other\" = \"grey\")) +\n  scale_size(range = c(2, 6)) +\n  #labs(title = \"<span style = 'color:#B5984F;'>Media and Journalism Cohort</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n```\n\n## Criminal Justice\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n#Criminal Justice subgraph on g\nggraph(g_non, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\")\n                  , threshold = .4\n                  , n_cycle =2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = degree, shape = grantee, color = ifelse(group == \"Criminal Justice\", \"Criminal Justice\", \"Other\")))+\n  geom_node_text(aes(label = ifelse(group == \"Criminal Justice\", acronym, NA)), size = 5, repel = TRUE, check_overlap = FALSE, max.overlaps = 20) +\n  ggforce::geom_mark_hull(\n    aes(x, y, group = cohort\n        , label = cohort\n        , filter = cohort == \"Criminal Justice\")\n    , fill = palette[[2]]\n    , label.colour = palette[[2]]\n    , label.fill = NA\n    , label.fontsize = 16\n    , con.colour = palette[[2]],\n    , concavity = 4,\n    expand = unit(2, \"mm\"),\n    alpha = 0.25\n  ) +\n  scale_color_manual(values = c(\"Criminal Justice\" = palette[[2]], \"Other\" = \"lightgrey\")) +\n  scale_size(range = c(2, 6)) +\n  #labs(title = \"<span style = 'color:#E17F48;'>Criminal Justice Cohort</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n\n```\n\n## JoinBodi\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n#JoinBodi subgraph on g\nggraph(g_non, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\")\n                  , threshold = .4\n                  , n_cycle = 2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = degree, shape = grantee, color = ifelse(group == \"JoinBodi\", \"JoinBodi\", \"Other\")))+\n  geom_node_text(aes(label = ifelse(group == \"JoinBodi\", acronym, NA)), size = 5, repel = TRUE, check_overlap = FALSE, max.overlaps = 20) +\n  ggforce::geom_mark_hull(\n    aes(x, y, group = cohort\n        , label = cohort\n        , filter = cohort == \"JoinBodi\")\n    , fill = palette[[3]]\n    , label.colour = palette[[3]]\n    , label.fill = NA\n    , label.fontsize = 16\n    , con.colour = palette[[3]],\n    , concavity = 4,\n    expand = unit(2, \"mm\"),\n    alpha = 0.25\n  ) +\n  scale_color_manual(values = c(\"JoinBodi\" = palette[[3]], \"Other\" = \"grey\")) +\n  scale_size(range = c(2, 6)) +\n #labs(title = \"<span style = 'color:#5B507A;'>JoinBodi Cohort</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n```\n:::\n\n::: panel-tabset\n## Cross Cohort Connectors\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n\n# cross community nodes\ncommunities <- V(g_non)$cohort\n\n\nV(g_non)$community <- V(g_non)$cohort \n\nV(g_non)$names_pretty <- stringr::str_wrap(V(g_non)$name, width = 20)\n#V(g_non)$filtered <- V(g_non)$grantee != \"Non Grantee\"\n\n#E(g_non)$cross_community <- V(g_non)[ends(g_non, E(g_non))[,1]]$community != V(g_non)[ends(g_non, E(g_non))[,2]]$community\n\n# Define the community to **exclude**\nexcluded_community <- \"Non Grantee\"\n\n# Identify edges that **connect to the excluded community**\nE(g_non)$involves_excluded <- V(g_non)[ends(g_non, E(g_non))[,1]]$community == excluded_community |\n  V(g_non)[ends(g_non, E(g_non))[,2]]$community == excluded_community\n\n# Identify cross-community edges **that do not involve the excluded community**\nE(g_non)$cross_community <- V(g_non)[ends(g_non, E(g_non))[,1]]$community != \n  V(g_non)[ends(g_non, E(g_non))[,2]]$community & \n  !E(g_non)$involves_excluded\n\n#Identify nodes that are at the ends of cross-community edges\ncross_community_nodes <- unique(as.vector(ends(g_non, E(g_non)[E(g_non)$cross_community])))\n\n#add an acronym column that only applies to cross-community nodes\nV(g_non)$acronym_cross <- ifelse(V(g_non)$name %in% cross_community_nodes, V(g_non)$acronym, NA)\n\n\nsubtitle <- \"<span style = 'font-size:18pt; color:#0964B0;'>**Behavior Change Cohort**</span>, <span style = 'font-size:18pt; color:#B5984F;'>**Media and Journalism Cohort**</span>, <span style = 'font-size:18pt; color:#E17F48;'>**Criminal Justice Cohort**</span>, <br><span style = 'font-size:18pt; color:#5B507A;'>**JoinBodi Cohort**</span>\"\n\ncross_cohort <- ggraph(g_non, \"stress\") +\n  geom_edge_bundle_force(aes(alpha = !involves_excluded), edge_color = \"white\"\n                  , edge_linewidth = .4\n                         , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                         , ends = \"last\", type = \"closed\"), threshold = .4, n_cycle = 2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\") +\n  geom_node_point(aes(size = degree, shape = grantee, color = cohort)) +\n  \n  #foreground\n  geom_edge_bundle_force(aes(alpha = cross_community, colour = cross_community), width = 1)+\n                     #, edge_linewidth = ifelse(color = TRUE, 2, .5))\n                        #, edge_linewidth = .4\n                      #, alpha = .8\n                      #  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                      #                  , ends = \"last\", type = \"closed\"), threshold = .4, n_cycle = 2) +\n   geom_node_point(aes(size = degree, shape = grantee, color = cohort)) +\n   #geom_node_point(data = ggraph(g_non_delete, \"stress\"), aes(size = degree, shape = grantee, color = cohort)) +\n   geom_node_text(aes(label = acronym_cross), size = 4, repel = TRUE\n                  , max.overlaps = Inf, na.rm = TRUE\n                  , nudge_y = .05\n                  ) +\n  #scale_edge_color_manual(values = c(\"TRUE\" = \"red\", \"FALSE\" = \"grey\")) +\n  scale_alpha_manual(values = c(\"TRUE\" = 1, \"FALSE\" = 0)) +\n  scale_edge_color_manual(values = c(\"TRUE\" = \"red\", \"FALSE\" = \"white\"))+\n   scale_size(range = c(2, 6)) +\n   scale_color_manual(values = palette)+\n  # scale_edge_color_manual(values = c(\"grey\", \"red\")) +\n   labs(title = \"Cross Cohort Connections \"\n        , subtitle = subtitle)+\n   theme_graph() +\n   theme(legend.position = \"bottom\"\n         , plot.subtitle = ggtext::element_markdown()) +\n   guides(color = \"none\", fill = \"none\")\n \ncross_cohort\n```\n\n## Cross Cohort Connectors: Zoomed-in\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n\ncross_cohort +\n  coord_cartesian(xlim = c(-6, 3), ylim = c(-8, 1))\n\n```\n:::\n","srcMarkdownNoYaml":"\n\n```{r}\nsource(here::here(\"./prep/prep.r\"))\nsource(here::here(\"./scripts/00 cleaning script.R\"))\nsource(here::here(\"./scripts/01 descriptives.R\"))\nsource(here::here(\"./scripts/01 analysis subgraphs script.R\"))\nsource(here::here(\"./scripts/01 analysis script.R\"))\n```\n\n## Centrality Statistics\n\nGlobal centrality statistics help understand each node's place in the overall network and whether or not they are connected to many or few other nodes in the network. Knowing this information helps to determine if an organization may be more or less influential than other organizations in the network.\n\nFour commonly used centrality statistics are Betweenness Centrality, Closeness, Eigenvector Centrality, and Degree Centrality (overall, out, and in).\n\n**Betweenness centrality** measures the extent to which an organization is connected to other network actors that are not connected to each other. Nodes with high betweenness serve as bridges between different parts of a network.\n\n**Closeness** calculates the average distance between a node and all other nodes in a network. It is used to identify nodes that reach other nodes quickly. In disconnected networks, it may be necessary to use **Harmonic Centrality** instead.\n\n**Eigenvector Centrality** is a measure of the influence of a node in a network. Those nodes that are connected to other well-connected nodes will have high eigenvector centrality scores.\n\n**Degree Centrality** is a count of the number of connections of each node. In directed networks it can have both an **in-degree** and an **out-degree** score. The out-degree score denotes the number of connections the node initiates, and the in-degree score denotes the number of connections the node receives. The overall degree score is the sum of the in-degree and the out-degree scores.\n\nAdditionally, a network's **density** is a useful statistic to understand, but it is hard to put in context. The calculation is the number of connections divided by the total possible number of connections. A network density of 1 means that all nodes are connected to each other. This is common in small, friend group networks, but less common in real-world networks. It would not make sense for a network to be perfectly dense, and optimal density is hard to define. The endline network has a density of `{r} igraph::edge_density(g_non)`.\n\n```{r}\n\ndat_all1 <- dat_all |> \n  mutate(Density = paste0(round(Density, digits = 0), \"%\")\n         , 'Avg. Harmonic Centrality \\n(Closeness)' = round(`Avg. Harmonic Centrality \\n(Closeness)`, digits = 2)\n         , 'Avg. Betweenness' = round(`Avg. Betweenness`, digits = 2)\n         , 'Avg. Eigenvector' = round(`Avg. Eigenvector`, digits = 2))\n\nflex_fun(data = dat_all1)\n\n```\n\n## Neighborhoods\n\n```{r}\nsource(here::here(\"./prep/prep.r\"))\nsource(here::here(\"./scripts/00 cleaning script.R\"))\nsource(here::here(\"./scripts/01 analysis script.R\"))\nsource(here::here(\"./scripts/01 analysis subgraphs script.R\"))\n\n```\n\nWithin this network of anti-corruption organizations, the grantees work within four thematic areas:\n\n-   Joinbodi\n-   Behavior Change\n-   Criminal Justice, and\n-   Media and Journalism.\n\nTo better understand each of these grantees and those non-grantees who are associated with each of them, the evaluation team created four **neighborhoods**, one for each of the cohorts. Each neighborhood consists of the grantee organizations who are officially part of this cohort, and all other organizations in the network -- grantee and non-grantee -- who are first order connections. Below, each neighborhood is presented visually and statistically to identify its key organizations.\n\n## Joinbodi\n\nThe Joinbodi neighborhoods consists of `{r} gorder(joinbodi_nbhd)` organizations and `{r} gsize(joinbodi_nbhd)` connections. The organizations are made up of `{r} sum(V(joinbodi_nbhd)$cohort == \"JoinBodi\")` that are JoinBodi grantees, `{r} sum(V(joinbodi_nbhd)$cohort %in% c(\"Media and Journalism\", \"Behavior Change\", \"Criminal Justice\"))` that are grantees in one of the other three cohorts, and `{r} sum(V(joinbodi_nbhd)$cohort == \"Non Grantee\")` non-grantees.\n\n```{r}\nDT::datatable(joinbodi_nbhd_centrality_scores,\n              caption = htmltools::tags$caption(\n    style = 'caption-side: bottom; text-align: left;',\n    'Table 1: ', htmltools::em('Centrality statistics the JoinBodi neighborhood.')\n  ))\n\n```\n\n### JoinBodi neighborhood network visualization\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\nggraph(joinbodi_nbhd, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\"), threshold = .4, n_cycle = 2) +\n  geom_node_point(aes(size = betweenness, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = betweenness, shape = grantee, color = ifelse(group == \"JoinBodi\", \"JoinBodi\", \"Other\")), alpha = .8)+\n  geom_node_text(aes(label = ifelse(group == \"JoinBodi\", names_pretty, NA)), size = 3, repel = TRUE) +\n  scale_color_manual(values = c(\"JoinBodi\" = palette[[3]], \"Other\" = \"grey\")) +\n  scale_size(range = c(2, 6)) +\n  labs(title = \"<span style = 'color:#5B507A;'>JoinBodi neighborhood</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n\n```\n\n### JoinBodi: Top 10 Organizations by Centrality Statistic\n\n```{r}\n\nflex_fun(scores_table_joinbodi)\n\n```\n\nEach of the four cohorts' nodes is highlighted in the panels below.\n\n::: panel-tabset\n## Behavior Change\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\nggraph(g_non, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\")\n                  , threshold = .4, n_cycle = 2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = degree, shape = grantee, color = ifelse(group == \"Behavior Change\", \"Behavior Change\", \"Other\")))+\n  geom_node_text(aes(label = ifelse(group == \"Behavior Change\", acronym, NA)), size = 5, repel = TRUE, check_overlap = FALSE, max.overlaps = 20) +\n  ggforce::geom_mark_hull(\n    aes(x, y, group = cohort\n        , label = cohort\n        , filter = cohort == \"Behavior Change\")\n    , fill = palette[[1]]\n    , label.colour = palette[[1]]\n    , label.fill = NA\n    , label.fontsize = 16\n    , con.colour = palette[[1]],\n    , concavity = 4,\n    expand = unit(2, \"mm\"),\n    alpha = 0.25\n  ) +\n  scale_color_manual(values = c(\"Behavior Change\" = palette[[1]], \"Other\" = \"grey\")) +\n  scale_size(range = c(2, 6)) +\n  #labs(title = \"<span style = 'color:#0964B0;'>Behavior Change Cohort</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n```\n\n## Media and Journalism\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n#Media and Journalism subgraph on g\nggraph(g_non, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\")\n                  , threshold = .4\n                  , n_cycle = 2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = degree, shape = grantee, color = ifelse(group == \"Media and Journalism\", \"Media and Journalism\", \"Other\")))+\n  geom_node_text(aes(label = ifelse(group == \"Media and Journalism\", acronym, NA)), size = 5, repel = TRUE, check_overlap = FALSE, max.overlaps = 20) +\n  ggforce::geom_mark_hull(\n    aes(x, y, group = cohort\n        , label = cohort\n        , filter = cohort == \"Media and Journalism\")\n    , fill = palette[[4]]\n    , label.colour = palette[[4]]\n    , label.fill = NA\n    , label.fontsize = 16\n    , con.colour = palette[[4]],\n    , concavity = 4,\n    expand = unit(2, \"mm\"),\n    alpha = 0.25\n  ) +\n  scale_color_manual(values = c(\"Media and Journalism\" = palette[[4]], \"Other\" = \"grey\")) +\n  scale_size(range = c(2, 6)) +\n  #labs(title = \"<span style = 'color:#B5984F;'>Media and Journalism Cohort</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n```\n\n## Criminal Justice\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n#Criminal Justice subgraph on g\nggraph(g_non, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\")\n                  , threshold = .4\n                  , n_cycle =2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = degree, shape = grantee, color = ifelse(group == \"Criminal Justice\", \"Criminal Justice\", \"Other\")))+\n  geom_node_text(aes(label = ifelse(group == \"Criminal Justice\", acronym, NA)), size = 5, repel = TRUE, check_overlap = FALSE, max.overlaps = 20) +\n  ggforce::geom_mark_hull(\n    aes(x, y, group = cohort\n        , label = cohort\n        , filter = cohort == \"Criminal Justice\")\n    , fill = palette[[2]]\n    , label.colour = palette[[2]]\n    , label.fill = NA\n    , label.fontsize = 16\n    , con.colour = palette[[2]],\n    , concavity = 4,\n    expand = unit(2, \"mm\"),\n    alpha = 0.25\n  ) +\n  scale_color_manual(values = c(\"Criminal Justice\" = palette[[2]], \"Other\" = \"lightgrey\")) +\n  scale_size(range = c(2, 6)) +\n  #labs(title = \"<span style = 'color:#E17F48;'>Criminal Justice Cohort</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n\n```\n\n## JoinBodi\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n#JoinBodi subgraph on g\nggraph(g_non, layout = \"stress\") +\n  geom_edge_bundle_force(edge_color = \"lightgrey\", edge_linewidth = .4, alpha = .8\n                  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                  , ends = \"last\", type = \"closed\")\n                  , threshold = .4\n                  , n_cycle = 2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\")+\n  geom_node_point(aes(size = degree, shape = grantee, color = ifelse(group == \"JoinBodi\", \"JoinBodi\", \"Other\")))+\n  geom_node_text(aes(label = ifelse(group == \"JoinBodi\", acronym, NA)), size = 5, repel = TRUE, check_overlap = FALSE, max.overlaps = 20) +\n  ggforce::geom_mark_hull(\n    aes(x, y, group = cohort\n        , label = cohort\n        , filter = cohort == \"JoinBodi\")\n    , fill = palette[[3]]\n    , label.colour = palette[[3]]\n    , label.fill = NA\n    , label.fontsize = 16\n    , con.colour = palette[[3]],\n    , concavity = 4,\n    expand = unit(2, \"mm\"),\n    alpha = 0.25\n  ) +\n  scale_color_manual(values = c(\"JoinBodi\" = palette[[3]], \"Other\" = \"grey\")) +\n  scale_size(range = c(2, 6)) +\n #labs(title = \"<span style = 'color:#5B507A;'>JoinBodi Cohort</span>\")+\n  theme_graph() +\n  theme(legend.position = \"none\"\n        , plot.title.position = \"plot\"\n        , plot.title = element_markdown())\n```\n:::\n\n::: panel-tabset\n## Cross Cohort Connectors\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n\n# cross community nodes\ncommunities <- V(g_non)$cohort\n\n\nV(g_non)$community <- V(g_non)$cohort \n\nV(g_non)$names_pretty <- stringr::str_wrap(V(g_non)$name, width = 20)\n#V(g_non)$filtered <- V(g_non)$grantee != \"Non Grantee\"\n\n#E(g_non)$cross_community <- V(g_non)[ends(g_non, E(g_non))[,1]]$community != V(g_non)[ends(g_non, E(g_non))[,2]]$community\n\n# Define the community to **exclude**\nexcluded_community <- \"Non Grantee\"\n\n# Identify edges that **connect to the excluded community**\nE(g_non)$involves_excluded <- V(g_non)[ends(g_non, E(g_non))[,1]]$community == excluded_community |\n  V(g_non)[ends(g_non, E(g_non))[,2]]$community == excluded_community\n\n# Identify cross-community edges **that do not involve the excluded community**\nE(g_non)$cross_community <- V(g_non)[ends(g_non, E(g_non))[,1]]$community != \n  V(g_non)[ends(g_non, E(g_non))[,2]]$community & \n  !E(g_non)$involves_excluded\n\n#Identify nodes that are at the ends of cross-community edges\ncross_community_nodes <- unique(as.vector(ends(g_non, E(g_non)[E(g_non)$cross_community])))\n\n#add an acronym column that only applies to cross-community nodes\nV(g_non)$acronym_cross <- ifelse(V(g_non)$name %in% cross_community_nodes, V(g_non)$acronym, NA)\n\n\nsubtitle <- \"<span style = 'font-size:18pt; color:#0964B0;'>**Behavior Change Cohort**</span>, <span style = 'font-size:18pt; color:#B5984F;'>**Media and Journalism Cohort**</span>, <span style = 'font-size:18pt; color:#E17F48;'>**Criminal Justice Cohort**</span>, <br><span style = 'font-size:18pt; color:#5B507A;'>**JoinBodi Cohort**</span>\"\n\ncross_cohort <- ggraph(g_non, \"stress\") +\n  geom_edge_bundle_force(aes(alpha = !involves_excluded), edge_color = \"white\"\n                  , edge_linewidth = .4\n                         , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                                         , ends = \"last\", type = \"closed\"), threshold = .4, n_cycle = 2) +\n  geom_node_point(aes(size = degree, shape = grantee), color = \"white\") +\n  geom_node_point(aes(size = degree, shape = grantee, color = cohort)) +\n  \n  #foreground\n  geom_edge_bundle_force(aes(alpha = cross_community, colour = cross_community), width = 1)+\n                     #, edge_linewidth = ifelse(color = TRUE, 2, .5))\n                        #, edge_linewidth = .4\n                      #, alpha = .8\n                      #  , arrow = arrow(angle = 15, length = unit(.05, \"inches\")\n                      #                  , ends = \"last\", type = \"closed\"), threshold = .4, n_cycle = 2) +\n   geom_node_point(aes(size = degree, shape = grantee, color = cohort)) +\n   #geom_node_point(data = ggraph(g_non_delete, \"stress\"), aes(size = degree, shape = grantee, color = cohort)) +\n   geom_node_text(aes(label = acronym_cross), size = 4, repel = TRUE\n                  , max.overlaps = Inf, na.rm = TRUE\n                  , nudge_y = .05\n                  ) +\n  #scale_edge_color_manual(values = c(\"TRUE\" = \"red\", \"FALSE\" = \"grey\")) +\n  scale_alpha_manual(values = c(\"TRUE\" = 1, \"FALSE\" = 0)) +\n  scale_edge_color_manual(values = c(\"TRUE\" = \"red\", \"FALSE\" = \"white\"))+\n   scale_size(range = c(2, 6)) +\n   scale_color_manual(values = palette)+\n  # scale_edge_color_manual(values = c(\"grey\", \"red\")) +\n   labs(title = \"Cross Cohort Connections \"\n        , subtitle = subtitle)+\n   theme_graph() +\n   theme(legend.position = \"bottom\"\n         , plot.subtitle = ggtext::element_markdown()) +\n   guides(color = \"none\", fill = \"none\")\n \ncross_cohort\n```\n\n## Cross Cohort Connectors: Zoomed-in\n\n```{r, fig.align=\"center\", fig.width=12, fig.height=10, out.width=\"100%\"}\n\ncross_cohort +\n  coord_cartesian(xlim = c(-6, 3), ylim = c(-8, 1))\n\n```\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["prep/styles.css"],"number-sections":false,"embed-resources":true,"toc":true,"output-file":"centrality_statistics.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","editor":"visual","theme":"cosmo","title":"Annex 3: More on Centrality Statistics"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}